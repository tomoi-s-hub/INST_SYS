<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSpecTor 1.02 システムなし公開版説明書</title>
</head>
<body>
    <p>----------------------------------------------------------------------------------------------
        <br>ドライブ存在チェック＆モードチェンジプログラム for PC-8801シリーズ
        <br>INSpecTor 1.02 システムなし公開版説明書
        <br>----------------------------------------------------------------------------------------------
        <br>        
        <br>このプログラムは、次の2つのモジュールをまとめたものです。
        <br>------------------------------------------------------------------
        <br>・ディスク存在チェックコマンド DeViceSTAT 3.00 (DVSTAT)
        <br>・モードチェンジプログラム CHecKDRiVe 3.00 (CHKDRV)
        <br>------------------------------------------------------------------
    </p>
    <p>これらは元々別の時期に作られましたが、DVSTATとCHKDRVを合わせ、INST.OBJに統一されました。
        <br>
        <br>DVSTAT は"POLL"コマンド拡張に対応し、CHKDRV は"ISET"コマンド拡張に対応します。
        <br>※上記拡張命令を別目的で使用中の方はご注意ください。
    </p>
    <p>------------------------------------------------------------------
        <br>ディスクイメージ ダウンロード
        <br>------------------------------------------------------------------
    </p>
    <p>ご使用の環境に合わせ、ディスクイメージを選択してください。
        <br>
        <br>INST V1.02　<a href="bin/2HD_MDCHG.D88">2HDディスクイメージ</a>
        <br>INST V1.02　<a href="bin/2D_MDCHG.D88">2Dディスクイメージ</a>
        <br>
        <br>INST.SYS　　<a href="bin/INST.SYS.TXT">初期化プログラム(アスキーセーブイメージ)</a>
        <br>※ディスクイメージに同梱されていますが、他のエディタ等で編集可能です。
    </p>
    <p>------------------------------------------------------------------
        <br>これは何ですか?
        <br>------------------------------------------------------------------
    </p>
    <p>PC-88系(等)のディスクBASICで生じる、膨大な時間ロスの原因を除去するものです。
        <br>
        <br>この機種のディスクBASICは、メディアがオフラインであるかを検出する
        <br>機構がなく、メディアを入れ忘れただけで長時間のアクセス待ちが生じます。
        <br>また、2HDメディアに対応した機種の場合、ディスクモードランプと異なる
        <br>種別のメディアを読み取ると、同様に長時間フリーズします。
        <br>
        <br>BIOS上にはこれに対処可能な機能がありますが、BASIC側では全く使用して
        <br>いないため、この機能を組み込んだ2種の拡張コマンドで、問題を解決します。
    </p>
    <p>------------------------------------------------------------------
        <br>「システムなし」とは何のことですか?
        <br>------------------------------------------------------------------
    </p>
    <p>この拡張は起動とともに利用可能であることを想定しているため、本来は
        <br>システムに組み込まれた状態が理想です。しかし、システムディスクごと
        <br>配布することはできないので、「システムなし」版として公開しています。
        <br>*最大限の利便性を発揮するため、システムに組み込むことを推奨しています。
    </p>
    <p>------------------------------------------------------------------
        <br>エミュレーターおよび実機での使用方法
        <br>------------------------------------------------------------------
    </p>
    <p>A.エミュレーターで実行する場合(2HD対応BIOSの利用を推奨します)
        <br>　システム起動後、"2D_MDCHG.D88"(2D用)または
        <br>　"2HD_MDCHG.D88"ディスクに切り替え、
        <br>        
        <br>　run "INST.SYS"
        <br>　を実行します。
        <br>
        <br>　成功すると、POLL と ISET コマンドが使用可能になります。
        <br>　*動かない場合、既に他の目的で占有されていないかご確認ください。
    </p>
    <p>B.2HD対応実機の場合(M・VAシリーズなど)
        <br>　2D_MDCHG.D88"(2D用)または"2HD_MDCHG.D88"を
        <br>　実ディスクに書き込んでください。
        <br>
        <br>　別途用意したシステムディスクからの起動後に
        <br>　起動モードに合わせたディスクに入れ替えて
        <br>　run "INST.SYS" を実行します。(以後は同じ)
        <br>
        <br>　(A.B.共にINST.SYSを自動実行に組み込んでおくと便利です。)
    </p>
    <p>------------------------------------------------------------------
        <br>コマンド解説
        <br>------------------------------------------------------------------
    </p>
    <p>・POLL
        <br>        
        <br>　機能　ドライブにディスクが存在するかチェックする
        <br>　書式　POLL [&lt;ドライブ番号&gt;]
        <br>　文例　POLL 2
        <br>
        <br>　解説　指定したドライブにディスクが存在するか調べます。
        <br>　※ドライブ番号の範囲は1から2までとします。
        <br>
        <br>　ドライブにディスクが装着されていなかった場合は、
        <br>　Disk Offline (エラーコード 62)が返され、実行が終了します。
        <br>　(プログラム内のエラートラップにも応用できます)
        <br>
        <br>・ISET
        <br>        
        <br>　機能　ドライブを調査し、必要に応じモード変更を行う
        <br>　書式　ISET
        <br>　文例　ISET
        <br>
        <br>　解説　ドライブ1と2の読み込みを試行し、挿入されている
        <br>　ディスクの内容に従って2Dまたは2HDモードに切り替えます。
        <br>
        <br>　実行結果はドライブランプの待機色により識別可能ですが、
        <br>　エミュレーション環境等でランプが可視でない実行環境では、ISET
        <br>　実行後にディスクが正常に読み書きできることで確認してください。
    </p>
    <p>------------------------------------------------------------------
        <br>補足
        <br>------------------------------------------------------------------
    </p>
    <p>モード変更完了時に、DSKF関数で取得される値も同期して変更されます。
        <br>この値に依存する処理をプログラム中に組み込んでいる場合は取扱にご注意ください。
        <br>※事前取得した後、値が固定されていると仮定しているもの等。
        <br>(ドライブランプのないエミュレーターでは、この値による遷移識別も可能です。)
        <br>        
        <br>※エミュレーション環境で同一ディスクをドライブ1・2に割り当てると動作不良になります。
        <br>実機上では行えない構成のため、プログラムから回避できません。
        <br>適正なディスク配置に戻した上でエミュレーションを再スタートしてください。
    </p>
    <p>------------------------------------------------------------------
        <br>参考：初期化用プログラム INST.SYS (全体)
        <br>------------------------------------------------------------------
    </p>
    <p>100 CONSOLE ,,0,1:DEFINT A-Z:REM "INST.SYS" ver 1.02 , by Tomoi,S. 1991,2011
        <br>110 DEFSTR R:R=CHR$(13):RW=CHR$(34):KEY 1,"run "+RW:KEY 2,"poll 1:files"+R:KEY 3,"load "+RW:KEY 6,"save "+RW+".":KEY 7,"poll 2:files 2"+R:KEY 8,"iset"+R
        <br>120 PRINT:BLOAD "INST.obj",R:RS="$F2FD"
        <br>130 PRINT "DVSTAT.SYS / Drive ready sens checker version 3.00 by Tomoi,S."
        <br>140 COLOR 7:PRINT "CHKDRV.SYS / Drive mode adapter version 3.00 by Tomoi,S."
        <br>150 COLOR 6:PRINT:PRINT "Program load address is $F220-"RS:PRINT
        <br>160 COLOR 7:PRINT "POLL command enhanced.":COLOR 7
        <br>170 PRINT "Return data address : ";:COLOR 6:PRINT RS:PRINT:COLOR 7
        <br>180 COLOR 7:PRINT "ISET command enhanced.":COLOR 7:PRINT:ISET
        <br>190 NEW
    </p>
    <p>------------------------------------------------------------------
        <br>初期化用プログラムの解説
        <br>------------------------------------------------------------------
    </p>
    <p>このプログラムは、ファンクションキー定義とオブジェクトのロード/実行を行い、自分自身を消去します。
        <br>＊再実行する必要はないため、NEWで終了しています。
        <br>
        <br>POLLのReturn dataはデバッグ時に使っていたもので、主に自分用です。(すみません)
        <br>
        <br>ファンクションキーは次の役割で定義されます。
        <br>------------------------------------------------------------------
        <br>1 run "
        <br>2 poll 1:files[CR]
        <br>3 load "
        <br>6 save ".
        <br>7 poll 2:files 2[CR]
        <br>8 ISET[CR]
        <br>------------------------------------------------------------------
        <br>
        <br>F1,F3,F6…開発当時の定義のため、お好みに合わせ再定義してください。
        <br>F2…普通のFILESです。対象ドライブにディスクがない場合は、"Disk Offline"が出て、待ち時間なく続行できます。
        <br>F7…上記動作をドライブ2に対して行います。
        <br>F8…初期化時にも実行されていますが、異なる容量のディスクと入れ替えて実行すると、読み取りの可否を試行し、2Dまたは2HDに自動でモードチェンジします。
        <br>
        <br>通常利用では「ディスク入れ替え後、ISETしてから使用開始する」のが最適な使い方になるかと思います。
        <br>
        <br>※ファンクションキー定義自体は説明(ガイド)用で、動作に一定の利便性はありますが必須ではありません。
        <br>　動作に慣れた後は、ご自身の適正な内容でお使いいただけます。
    </p>
    <p>------------------------------------------------------------------
        <br>補足 (システムディスクに組み込みたい場合)
        <br>------------------------------------------------------------------
    </p>
    <p>OBJファイルのシステムディスクへの転送方法
        <br>
        <br>まず、2Dまたは2HDのシステムディスクを作成します。
        <br>純正ディスクツールでのファイルコピー機能で、「ディスク」を選択し、
        <br>転送方向をシステムディスクに向けると、すべてのファイルが一括複写されます。
        <br>
        <br>OBJに関してはHIT-88のOBJ生成以外で書き込みしてなかったため、
        <br>良いセーブ文字列が思い浮かびませんでしたのでこれをお試しください(^-^;
        <br>
        <br>その他、何かございましたら下記までご連絡ください。
        <br>プログラムは開発が終了しているため現状のままでの対応となりますが、
        <br>システムディスク組込等のご質問・対応が必要であればお気軽にお知らせください。
        <br>(システム入りのイメージデータだけでもあれば、配置してお渡しすることができます。)
    </p>
    <p>------------------------------------------------------------------
        <br>作った人、及び連絡先
        <br>------------------------------------------------------------------
        <br>by 友井 純夫 / X: Tomoi_S / tomoi.s002[at]gmail.com
        <br>
        <br>2025/11/05 システムなし公開版作成
        <br>2026/01/15 WEB公開用説明書作成
        <br>
        <br>
    </p>
</body>
</html>